<!DOCTYPE html><html lang="zh-cn"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="装饰器在Angular中是个很常见的概念,&lt;code&gt;@Component&lt;/code&gt;、&lt;code&gt;@Directive&lt;/code&gt;、&lt;code&gt;@Pipe&lt;/code&gt;、&lt;code&gt;@NgModule&lt;/code&gt;、&lt;code&gt;@Injectable&lt;/code&gt;、&lt;code&gt;@Input&lt;/code&gt;、&lt;code&gt;@Inject&lt;/code&gt;等等.本文着重讲解各种装饰器的作用以及在Angular中的实际使用"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>装饰器与Angular | Mccc</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 7.3.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-noise-link" href="/tags/Angular/" rel="tag">Angular</a></div><div class="post-time">2022-02-15</div></div></div><div class="container post-header"><h1>装饰器与Angular</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion"></summary><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%B7%A5%E5%8E%82"><span class="toc-number">1.</span> <span class="toc-text">装饰工厂</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E8%A3%85%E9%A5%B0"><span class="toc-number">2.</span> <span class="toc-text">类装饰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E8%A3%85%E9%A5%B0"><span class="toc-number">3.</span> <span class="toc-text">方法装饰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E8%A3%85%E9%A5%B0"><span class="toc-number">4.</span> <span class="toc-text">属性装饰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%99%A8%E8%A3%85%E9%A5%B0"><span class="toc-number">5.</span> <span class="toc-text">访问器装饰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%A3%85%E9%A5%B0"><span class="toc-number">6.</span> <span class="toc-text">参数装饰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">7.</span> <span class="toc-text">实例</span></a></li></ol></details></div><div class="container post-content"><p>装饰器在Angular中是个很常见的概念,<code>@Component</code>、<code>@Directive</code>、<code>@Pipe</code>、<code>@NgModule</code>、<code>@Injectable</code>、<code>@Input</code>、<code>@Inject</code>等等.本文着重讲解各种装饰器的作用以及在Angular中的实际使用</p>
<br>

<h3 id="装饰工厂"><a href="#装饰工厂" class="headerlink" title="装饰工厂"></a>装饰工厂</h3><p>装饰器工厂只是一个函数，它返回将由装饰器在运行时调用的表达式</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function color(value: string) &#123;</span><br><span class="line">    // this is the decorator factory, it sets up</span><br><span class="line">    // the returned decorator function</span><br><span class="line">  return function (target) &#123;</span><br><span class="line">    // this is the decorator</span><br><span class="line">    // do something with &#x27;target&#x27; and &#x27;value&#x27;...</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<br>


<h3 id="类装饰"><a href="#类装饰" class="headerlink" title="类装饰"></a>类装饰</h3><p>类型注释:</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type ClassDecorator = &lt;TFunction extends Function&gt;</span><br><span class="line">  (target: TFunction) =&gt; TFunction | void;</span><br></pre></td></tr></table></figure></div>
<ul>
<li><p>@参数:</p>
<p>1.<code>target</code>:类的构造函数</p>
</li>
<li><p>@Returns</p>
<p>如果类装饰器返回一个值，它将替换类声明。<br>因此，它适用于扩展具有某些属性或方法的现有类。</p>
</li>
</ul>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">function toString() &#123;</span><br><span class="line">  return function &lt;T extends &#123; new (...args: any[]): any &#125;&gt;(constructor: T) &#123;</span><br><span class="line">    return class extends constructor &#123;</span><br><span class="line">      toString() &#123;</span><br><span class="line">        return JSON.stringify(this);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@toString()</span><br><span class="line">class C &#123;</span><br><span class="line">  public foo = &quot;foo&quot;;</span><br><span class="line">  public num = 24;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(new C().toString())</span><br><span class="line">// -&gt; &#123;&quot;foo&quot;:&quot;foo&quot;,&quot;num&quot;:24&#125;</span><br></pre></td></tr></table></figure></div>

<br>


<h3 id="方法装饰"><a href="#方法装饰" class="headerlink" title="方法装饰"></a>方法装饰</h3><p>类型注释:</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type MethodDecorator = &lt;T&gt;(</span><br><span class="line">  target: Object,</span><br><span class="line">  propertyKey: string | symbol,</span><br><span class="line">  descriptor: TypedPropertyDescriptor&lt;T&gt;</span><br><span class="line">) =&gt; TypedPropertyDescriptor&lt;T&gt; | void;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>@参数:</p>
<p>1.<code>target</code>:类的构造函数或实例成员的类的原型</p>
<p>2.<code>propertyKey</code>:属性名称</p>
<p>3.<code>descriptor</code>:成员的属性描述符</p>
</li>
<li><p>@Returns</p>
<p>如果返回一个值，它将作为成员的描述符</p>
</li>
</ul>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">function logger(target: any, propertyKey: string, descriptor: PropertyDescriptor) &#123;</span><br><span class="line">  const original = descriptor.value;</span><br><span class="line"></span><br><span class="line">  descriptor.value = function (...args) &#123;</span><br><span class="line">    console.log(&#x27;params: &#x27;, ...args);</span><br><span class="line">    const result = original.call(this, ...args);</span><br><span class="line">    console.log(&#x27;result: &#x27;, result);</span><br><span class="line">    return result;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class C &#123;</span><br><span class="line">  @logger</span><br><span class="line">  add(x: number, y:number ) &#123;</span><br><span class="line">    return x + y;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const c = new C();</span><br><span class="line">c.add(1, 2);</span><br><span class="line">// -&gt; params: 1, 2</span><br><span class="line">// -&gt; result: 3</span><br></pre></td></tr></table></figure></div>

<br>

<h3 id="属性装饰"><a href="#属性装饰" class="headerlink" title="属性装饰"></a>属性装饰</h3><p>类型注释:</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type PropertyDecorator = </span><br><span class="line">  (target: Object, propertyKey: string | symbol) =&gt; void;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>@参数:</p>
<p>1.<code>target</code>:类的构造函数或实例成员的类的原型</p>
<p>2.<code>propertyKey</code>:属性名称</p>
</li>
<li><p>@Returns</p>
<p>如果返回一个值，它将作为属性的描述符</p>
</li>
</ul>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class Greeter &#123;</span><br><span class="line">  @format(&quot;Hello, %s&quot;)</span><br><span class="line">  greeting: string;</span><br><span class="line">  </span><br><span class="line">  constructor(message: string) &#123;</span><br><span class="line">    this.greeting = message;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function format(value:string)&#123;</span><br><span class="line">  return function(target:any,propertyKey:string)&#123;	</span><br><span class="line">    return &#123;</span><br><span class="line">      configurable: true,</span><br><span class="line">      writable: true,</span><br><span class="line">      value:value</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<br>

<h3 id="访问器装饰"><a href="#访问器装饰" class="headerlink" title="访问器装饰"></a>访问器装饰</h3><p>访问器装饰器通常与方法装饰器相同，唯一的区别是描述符中的键：</p>
<p>方法装饰器中的描述符具有键：</p>
<ul>
<li>value</li>
<li>writable</li>
<li>enumerable</li>
<li>configurable</li>
</ul>
<p>访问器装饰器中的描述符具有键：</p>
<ul>
<li>get</li>
<li>set</li>
<li>enumerable</li>
<li>configurable</li>
</ul>
<br>

<h3 id="参数装饰"><a href="#参数装饰" class="headerlink" title="参数装饰"></a>参数装饰</h3><p>类型注释:</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type ParameterDecorator = (</span><br><span class="line">  target: Object,</span><br><span class="line">  propertyKey: string | symbol,</span><br><span class="line">  parameterIndex: number</span><br><span class="line">) =&gt; void;</span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>@参数:</p>
<p>1.<code>target</code>:类的构造函数或实例成员的类的原型</p>
<p>2.<code>propertyKey</code>:属性名称（方法名，不是参数名）</p>
<p>3.<code>parameterIndex</code>：函数参数列表中参数的序号索引</p>
</li>
<li><p>@Returns</p>
<p>返回值将被忽略。</p>
</li>
</ul>
<br>

<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>有如下的button组件,在传入danger输入属性时,根据不同的值,传入不同的值以此来改变按钮样式,</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">..</span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &#x27;button[my-button]&#x27;,</span><br><span class="line">  exportAs: &#x27;myButton&#x27;,</span><br><span class="line">  changeDetection: ChangeDetectionStrategy.OnPush,</span><br><span class="line">  encapsulation: ViewEncapsulation.None,</span><br><span class="line">  preserveWhitespaces: false,</span><br><span class="line">  template: ` &lt;ng-content&gt;&lt;/ng-content&gt; `,</span><br><span class="line">  host: &#123;</span><br><span class="line">    class: &#x27;btn&#x27;,</span><br><span class="line">    &#x27;[class.btn-dangerous]&#x27;: `danger`, //danger参数决定是否加载样式</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">export class ButtonComponent &#123;</span><br><span class="line">  @Input() danger : boolean= false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>实际使用时,组件的使用:<code>&lt;button my-button [danger]=&quot;true&quot;&gt;btn&lt;/button&gt;</code>,danger的入参过于繁琐,通过给danger添加装饰器来达到将不符合的类型值转化为布尔值;已达到<code>&lt;button my-button danger&gt;btn&lt;/button&gt;</code>的效果</p>
<p>定义参数装饰器,引入<code>@angular/cdk</code>的<code>coerceBooleanProperty</code>方法将值转换为布尔;</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">function InputBoolean()&#123;</span><br><span class="line">	return function (  target: any,propertyKey: string)&#123;</span><br><span class="line">       const privatePropName = `$$__private__$&#123;propName&#125;`;</span><br><span class="line">		</span><br><span class="line">       //创建新的属性并设置属性描述</span><br><span class="line">       Object.defineProperty(target, privatePropName, &#123;</span><br><span class="line">      	 configurable: true,</span><br><span class="line">     	 writable: true,</span><br><span class="line">   	   &#125;);  </span><br><span class="line">       </span><br><span class="line">      /**</span><br><span class="line">        * 返回新的属性描述 </span><br><span class="line">        * 来达到如下效果</span><br><span class="line">		* // @Input()</span><br><span class="line">        * // get visible() &#123; return this.__visible; &#125;</span><br><span class="line">        * // set visible(value) &#123; this.__visible = value; &#125;</span><br><span class="line">        * // __visible = false;</span><br><span class="line">        */</span><br><span class="line">      return &#123;</span><br><span class="line">        get(): string &#123;</span><br><span class="line">          this[privatePropName];</span><br><span class="line">        &#125;,</span><br><span class="line">        set(value: T): void &#123;</span><br><span class="line">          this[privatePropName] = coerceBooleanProperty(value);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<p>之后使用定义好的装饰器,此时使用组件并设置danger参数时,angular会有<code>Type &#39;string&#39; is not assignable to type &#39;boolean&#39;</code>的报错</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">export class ButtonComponent &#123;</span><br><span class="line">  @Input() @InputBoolean() danger : boolean= false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//danger会提示报错 </span><br><span class="line">&lt;button my-button danger&gt;btn&lt;/button&gt;</span><br></pre></td></tr></table></figure></div>

<p>此时通过添加<code>ngAcceptInputType_</code>前缀来放宽入参的类型</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">export type BooleanInput = boolean | string | undefined | null;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">export class ButtonComponent &#123;</span><br><span class="line">  static ngAcceptInputType_danger: BooleanInput;</span><br><span class="line">  </span><br><span class="line">  @Input() @InputBoolean() danger : boolean= false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>完整代码</p>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//button.component.js</span><br><span class="line">...</span><br><span class="line">@Component(&#123;</span><br><span class="line">  selector: &#x27;button[my-button]&#x27;,</span><br><span class="line">  exportAs: &#x27;myButton&#x27;,</span><br><span class="line">  changeDetection: ChangeDetectionStrategy.OnPush,</span><br><span class="line">  encapsulation: ViewEncapsulation.None,</span><br><span class="line">  preserveWhitespaces: false,</span><br><span class="line">  template: ` &lt;ng-content&gt;&lt;/ng-content&gt; `,</span><br><span class="line">  host: &#123;</span><br><span class="line">    class: &#x27;ant-btn&#x27;,</span><br><span class="line">    &#x27;[class.ant-btn-dangerous]&#x27;: `danger`,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line">export class ButtonComponent  &#123;</span><br><span class="line">  static ngAcceptInputType_danger: BooleanInput;</span><br><span class="line"></span><br><span class="line">  @Input() @InputBoolean() danger = false;</span><br><span class="line"></span><br><span class="line">  constructor() &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">//util/convert.ts</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">import &#123;</span><br><span class="line">  coerceBooleanProperty,</span><br><span class="line">  coerceCssPixelValue,</span><br><span class="line">  _isNumberValue,</span><br><span class="line">&#125; from &#x27;@angular/cdk/coercion&#x27;;</span><br><span class="line"></span><br><span class="line">export function toBoolean(value: boolean | string): boolean &#123;</span><br><span class="line">  return coerceBooleanProperty(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function propDecoratorFactory&lt;T, D&gt;(</span><br><span class="line">  name: string,</span><br><span class="line">  fallback: (v: T) =&gt; D</span><br><span class="line">): (target: any, propName: string) =&gt; void &#123;</span><br><span class="line">  function propDecorator(</span><br><span class="line">    target: any,</span><br><span class="line">    propertyKey: string,</span><br><span class="line">    originalDescriptor?: TypedPropertyDescriptor&lt;any&gt;</span><br><span class="line">  ): any &#123;</span><br><span class="line">    const privatePropName = `$$__private__$&#123;propertyKey&#125;`;</span><br><span class="line"></span><br><span class="line">    if (Object.prototype.hasOwnProperty.call(target, privatePropName)) &#123;</span><br><span class="line">      console.warn(</span><br><span class="line">        `The prop &quot;$&#123;privatePropName&#125;&quot; is already exist, it will be overrided by $&#123;name&#125; decorator.`</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    Object.defineProperty(target, privatePropName, &#123;</span><br><span class="line">      configurable: true,</span><br><span class="line">      writable: true,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">      get(): string &#123;</span><br><span class="line">        return originalDescriptor &amp;&amp; originalDescriptor.get</span><br><span class="line">          ? originalDescriptor.get.bind(this)()</span><br><span class="line">          : this[privatePropName];</span><br><span class="line">      &#125;,</span><br><span class="line">      set(value: T): void &#123;</span><br><span class="line">        if (originalDescriptor &amp;&amp; originalDescriptor.set) &#123;</span><br><span class="line">          originalDescriptor.set.bind(this)(fallback(value));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        this[privatePropName] = fallback(value);</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return propDecorator;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function InputBoolean(): any &#123;</span><br><span class="line">  return propDecoratorFactory(&#x27;InputBoolean&#x27;, toBoolean);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//convert-input.ts</span><br><span class="line">export type BooleanInput = boolean | string | undefined | null;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div></div></div><div class="post-main post-comment"><div id="giscus_thread"></div><script src="https://giscus.app/client.js"
        data-repo="angelise7/blog-comments"
        data-repo-id="R_kgDOPQr6lw"
        data-category=""
        data-category-id=""
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script></div></article><link rel="stylesheet" type="text/css" href="/css/third-party/font-awesome/4.5.0/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/lato-font/3.0.0/css/lato-font.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.css"><script src="/js/third-party/jquery/2.0.3/jquery.min.js"></script><script src="/js/third-party/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>