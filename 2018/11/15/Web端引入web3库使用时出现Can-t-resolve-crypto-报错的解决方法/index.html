<!DOCTYPE html><html lang="zh-cn"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="当我们在Angular中引入web3时,由于Angular-cli的限制,会出现Can’t Resolve ‘Crypto’这个报错信息.但是浏览器确实有加密支持的&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Window/crypto&quot;&gt; https://developer.mozilla.org/en-US/docs/Web/API/Window/crypto&lt;/a&gt;"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>Angular使用web3时出现Can't Resolve 'Crypto' 报错的解决方法 | Mccc</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 7.3.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-noise-link" href="/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/" rel="tag">区块链</a></div><div class="post-time">2018-11-15</div></div></div><div class="container post-header"><h1>Angular使用web3时出现Can't Resolve 'Crypto' 报错的解决方法</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion"></summary><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AApatch-js%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">1.新建一个patch.js文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%9C%A8package-json%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%91%BD%E4%BB%A4"><span class="toc-number">2.</span> <span class="toc-text">2.在package.json中添加命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4%E5%90%8E%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE%E5%8D%B3%E5%8F%AF"><span class="toc-number">3.</span> <span class="toc-text">3.运行命令后启动项目即可</span></a></li></ol></details></div><div class="container post-content"><p>当我们在Angular中引入web3时,由于Angular-cli的限制,会出现Can’t Resolve ‘Crypto’这个报错信息.但是浏览器确实有加密支持的<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/crypto"> https://developer.mozilla.org/en-US/docs/Web/API/Window/crypto</a></p>
<p>官方开发团队给出的解释说在默认情况下大多数项目都不适用加密服务,因此会删除该部分的buildin来减少文件大小.</p>
<p>下面提供一种方法,可以通过补丁的方式来解决问题:</p>
<h4 id="1-新建一个patch-js文件"><a href="#1-新建一个patch-js文件" class="headerlink" title="1.新建一个patch.js文件"></a>1.新建一个patch.js文件</h4><div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const fs = require(&#x27;fs&#x27;)</span><br><span class="line">const file = &#x27;./node_modules/@angular-devkit/build-angular/src/angular-cli-files/models/webpack-configs/browser.js&#x27;;</span><br><span class="line">//此处为angular6的路径配置</span><br><span class="line">//angular4的路径配置为:./node_modules/@angular/cli/models/webpack-configs/browser.js</span><br><span class="line"></span><br><span class="line">fs.readFile(file, &#x27;utf8&#x27;, function (err, data) &#123;</span><br><span class="line">  if (err) &#123;</span><br><span class="line">    return console.log(err);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  var result = data.replace(/node: false/g, &#x27;node: &#123;crypto: true, stream: true&#125;&#x27;);</span><br><span class="line"></span><br><span class="line">  fs.writeFile(file, result, &#x27;utf8&#x27;, function (err) &#123;</span><br><span class="line">    if (err) return console.log(err);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h4 id="2-在package-json中添加命令"><a href="#2-在package-json中添加命令" class="headerlink" title="2.在package.json中添加命令"></a>2.在package.json中添加命令</h4><div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    ...</span><br><span class="line">   &quot;postinstall&quot;: &quot;node bin/patch.js&quot;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure></div>

<h4 id="3-运行命令后启动项目即可"><a href="#3-运行命令后启动项目即可" class="headerlink" title="3.运行命令后启动项目即可"></a>3.运行命令后启动项目即可</h4><div class="noise-code-block" style="--code-block-max-height:inherit;"><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run postinstall</span><br></pre></td></tr></table></figure></div>


<p>注意: 由于不同版本的Angular的webpack配置文件的路径不同,请根据自己的版本来更换file路径</p>
</div></div><div class="post-main post-comment"><div id="disqus_thread"></div><script type="text/javascript">
var disqus_shortname = 'MCCC-1';
var disqus_identifier = '2018/11/15/Web端引入web3库使用时出现Can-t-resolve-crypto-报错的解决方法/';
var disqus_title = 'Angular使用web3时出现Can't Resolve 'Crypto' 报错的解决方法';
var disqus_url = 'http://example.com/2018/11/15/Web%E7%AB%AF%E5%BC%95%E5%85%A5web3%E5%BA%93%E4%BD%BF%E7%94%A8%E6%97%B6%E5%87%BA%E7%8E%B0Can-t-resolve-crypto-%E6%8A%A5%E9%94%99%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a target="_blank" rel="noopener" href="http://disqus.com" class="dsq-brlink">Blog comments powered by <span class="logo-disqus">Disqus</span></a><div id="giscus_thread"></div><script src="https://giscus.app/client.js"
        data-repo="angelise7/blog-comments"
        data-repo-id="R_kgDOPQr6lw"
        data-category=""
        data-category-id=""
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script></div></article><link rel="stylesheet" type="text/css" href="/css/third-party/font-awesome/4.5.0/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/lato-font/3.0.0/css/lato-font.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.css"><script src="/js/third-party/jquery/2.0.3/jquery.min.js"></script><script src="/js/third-party/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>